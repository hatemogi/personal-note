# 클로저와 자바, 다른 모습의 같은 플랫폼

> 좀 특이한 프로그래밍 언어인 클로저(Clojure)는, 개인적으로만 쓸 줄 알았습니다. 강력하고 매력적인 프로그래밍 언어임에는 틀림 없지만, 다른 개발자들도 쉽게 좋아할 수 있는 언어는 아니잖아요. 게다가 제가 속한 대부분의 조직에서는 프로그래밍 언어의 사용 폭이 아주 제한적으로 수렴되는 경향을 보아왔기 때문에, 앞으로도 클로저를 업무에 쓰리라는 기대는 없었지요. 그런데, 그런 일이 실제로 벌어졌습니다! 얼마전 서울에 위치한 스타트업 S사와 계약을 하게됐고, 뜻밖에도 클로저로 개발하게 된 거죠. 이런 배경에서, 언어의 선택에 대한 잡담을 털어 놓아 봅니다. 어쩌면 자바 위주로 개발하시는 다른 백엔드 개발자 분들에게도 업무환경에서 클로저를 쓸만한 부분을 소개해드릴 수 있을지도 모르겠습니다. 과연?!

## 새로운 프로그래밍 언어를 배우기 어려운 이유

평소 쓰던 프로그래밍 언어, 특히 업무로 쓰던 것과 다른 프로그래밍 언어를 재미로 배울 때의 결정적인 문제는, 배우는 노력을 지속하기 어렵다는 점이 아닐까 합니다. 아무래도 꼭 해야 하는 일에 매일 쓰는 언어와, 재미삼아 여가시간에 배워보는 언어에 들이는 노력에는 큰 격차가 나는 거지요.

어쩌다 새로운 언어에 관심이 생겨 큰 맘 먹고 책도 사고 문서도 읽어보며 공부하더라도, 결국 그걸 활용할 프로젝트나 함께 토론하며 개발할 동료가 없으니, 금새 시들해져 관심의 영역에서 떠나버리기 쉬운 것 같습니다. 프로그래밍 언어도 자주 써서 익숙해져야 진짜 내 것이 되는 것인데, 익숙해지기까지 노력을 지속하기 어렵다는 말씀입니다.

제가 흥미롭게 공부하고 있는 신박한 프로그래밍 언어인 클로저(Clojure)도 마찬가지입니다. 참 매력적인 언어이고 공부하면 할 수록 프로그래밍 언어계의 끝판왕이라는 생각이 들지만, 평소 써먹을 일이 없으니, 괜한 입만만 다시거나 아예 그만두게 되어 지속적인 연습을 할 수 없는 거지요. 아무리 훌륭하면 뭐하나요? 써먹을 일이 없는데.

이 글의 후반에 이런 한계를 극복해서 실제로 활용할 방법을 몇 가지 제안해 보겠습니다.

## 업무 환경에 새로운 언어를 도입하는 문제

그렇다고 나 혼자 욕심으로, 새로운 언어를 다른 사람과 함께 일하는 업무 환경에 끌어들이는 일은, 동료들의 성향과 소속한 회사의 정책을 비롯해 다양한 저항이 커서 현실적으로 어렵습니다. 아예 개발 무대가 확 바뀌어서 응당 "기본적으로" 해당 언어나 프레임워크를 새로 도입하는 상황이라면 모를까, 이미 있는 언어 환경을 같은 목적의 다른 언어로 교체하는 것은 매우 어려운 일이고, 또 그래야 할 필요도 없습니다. 교체해서 얻는 잠재적 이득에 비해, 들여야 하는 뻔한 노력이 너무 커서, 현실적으로 옳은 선택이기 힘듭니다. 얻을 이득은 아직 불투명한 반면, 투자해야 하는 비용은 너무도 또렷하게 보이거든요. 얻을 이득을 높게 평가하는 것은 이미 새 언어에 깊게 마음을 뺏긴 당신 뿐이겠지만, 투자해야하는 비용을 큰 손실로 여기는 사람이 대부분일 겁니다. 그리고 우리들은 이득보다 손실을 더 크게 여기는 경향이 있습니다. 1만원을 길에서 주운 즐거움의 크기보다 1만원을 잃었을 때의 아픔이 훨씬 큽니다.

그래서, 백엔드 개발에 이미 Java를 주로 쓰는 회사에서 갑자기 Ruby나 Python을 가져다 쓰겠다는 것은 괜한 마찰을 일으키고, 그걸 주장하는 개인도 불필요한 에너지를 소모하기 쉽습니다. 파이썬처럼 꽤 대중적인 언어를 도입하는 것도 힘든데, 하물며 해괴하게 생긴 클로저라구요? 얼토당토 않은 바램인 거죠, 입도 뻥긋하지 마십시다요.

## 언어나 프레임워크 선택은 취향의 문제

프로그래밍 언어를 선택하는 것은 합리적인 판단의 영역으로 보이지만, 깊게 따져보면 그 결정을 하는 사람들의 감성적 취향 문제가 아닌가 생각합니다. 이미 감성적 취향 판단이 앞서고, 그 뒤에 합리화가 따라오는 것으로 보입니다. 어떤 언어로 문제를 푸는데 더 효율적이고 편리하고 우아하다고 여길만한 갖가지 이성적 판단 기준이 있겠습니다만, 그렇다고 해서 다른 프로그래밍 언어로 그 일을 못하는 것나 뚜렷한 격차가 날 만큼은 아닙니다. 한 언어가 뛰어난 점이 있으면 약점도 있고, 설령 약점이 많더라도 그걸 이미 해당 언어 커뮤니티나 조직내 구성원들의 노력으로 보완해 놓은 경우가 많지요. 간단하게는 어느정도 이상 활발하게 쓰이는 언어면 괜찮습니다. 다양한 사람들이 갖가지 문제를 이미 겪었고, 해당 문제를 해결할 사람들도 많은 거죠.

한편, 요새 세상에도 펄이나 코볼 같은 언어가 아직도 잘 쓰이고 있는 판에, 사실 언어의 기능적 제약으로 안 될 일은 없습니다. 어떻게든 최종적으로 기계어를 뽑아낼 수 있으면 되고, 아무리 무능한 언어라도 다른 호스트 시스템의 다른 언어 코드를 불러다 쓰는 길은 열려 있으니, 한 언어가 할 수 있는 일을 다른 언어라고 해서 못하는 일은 거의 없습니다. NASA에서 로켓을 쏘아 올리는데도 아직 코볼이나 포트란을 널리 쓰고 있을 텐데, 구식의 언어라서 어떤 일을 못한다고 얘기할 수는 없잖아요. 우리가 개발 하는 일이 로켓 쏴 올리는 일 만큼 최첨단(?)도 아닐 테고요.

어떤 팀의 구성원들끼리나, 또는 개발자 한 명이 개인적으로 어떤 프로그래밍 언어를 택하는 문제에 있어서의 합리적 근거들을 곰곰히 따져보면, 전 그냥 취향의 문제로 보입니다. 호감이 가는 스타일이 있고, 그 스타일에 잘 맞는 언어는 좋은 언어이고, 그렇지 않은 언어는 나쁜 언어입니다. 언어가 갖고 있는 다양한 가치들을 각 개인이 얼마나 높은 가산점을 두고 있느냐에 따라 평점이 달라지는 거라고 봅니다, 본인들은 아니라고 말 할지 모르겠지만요.

저도 제가 클로저를 좋아할만한 이유는 매우 합리적이라고 여깁니다. 절대 감성적인 취향일리 없습니다, 분명히. ;-)

## 프로그래밍 언어는 도구에 불과하다는 주장에 대해

이런 감성(?)이 커지다 보면 프로그래밍 언어가 마치 종교인 것처럼 깊게 빠져드는 사람들도 있고, 그 반대편에는 지나치게 합리적인 사람들이 프로그래밍 언어는 도구에 불과하다며 상당한 거리감을 두고 바라보기도 합니다. 어느 쪽 주장이 더 옳은 지는 모르겠지만, 진실은 그 중간 어디쯤에 있다고 말하면 틀림 없을 것 같습니다. 프로그래밍 언어가 전부도 아니고, 그렇다고 도구에 불과한 것만은 아닌 그 중간 어디쯤인 거죠. 언어와 도구는 상호작용하는 것은 당연하고, 그 언어를 사용하는 커뮤니티의 성향과 문화에 따라서 어떤 일을 해내는 데 드는 노력과 우아함이 매우 다르기도 합니다. 그렇다고 해서 그게 전부라고 할 수도 없고요. 그 중간 어디쯤!

## Java의 장단점

자바는 제 직업 경력에서 가장 많이 활용한 언어이고, 지금도 제 생계소득을 받쳐주는 감사한 언어이지만, 개인적 취향에 안맞는 점을 꼽자면, 언어의 스타일이 너무 구체적이고 명시적이어서, 제게는 좀 거북한 언어입니다. 사소하지만 간단한 예로, 요새 세상에 세미콜론이 필수인 언어가 어디 흔한가요? 대체 그 세미콜론이 왜 필수인 겁니까? 언어의 기본 스타일이 장황하다보니, 커뮤니티에서 태어나는 라이브러리나 프레임워크들도 그런 문화적 영향의 아래에 있는 것 같습니다. 뭐하나 간단한 일을 하는데도, 너무 거창하게 접근하는 게 아닌가 하는 생각이 종종 듭니다.

하지만, 그 과도히 명시적인 표현이 장점일 수도 있습니다. 여럿이서 팀으로 일할 때 실수의 여지가 적다거나, 아니면 표현이 구체적이니 혼동의 여지가 적다거나, 아니면 처음에 접근하기 쉬우니까, 잠재적 구성원을 구하기 쉽다거나 하는 다양한 장점들이 있지요. 제 개인 취향에 호감이 적을 뿐, 분명 현재 대중적으로는 압도적으로 많이 쓰이는 언어임에는 틀림 없습니다.

``` java
@CleverAnnotation(value="whatever", required=false)
public static final Optional<ResultWithNoSpecificPurposeOtherThanWrapping>  longMethodNameWithOverClarification(Stream<HeavyContainer<IFancyEntity>> inputStream) throws AnnoyingCheckedExceptionName {
   // some tiny task with meaningless separation ...
}
```

그리고, 언어 자체의 개인적 호감도를 떠나서 보면, 자바 생태계가 자랑하고 있는 각종 도구와 세상의 그 모든 라이브러리들은 누구라도 높게 평가할 수 밖에 없는 매력포인트일 겁니다.

## Clojure의 장단점

    (def 클로저 (+ JVM LISP 현대적-동시성-처리))

클로저는 LISP의 극도로 간단한 문법에, 동시성 처리를 위한 현대적 접근이 녹아들어 있는 JVM 기반의 프로그래밍 언어입니다. 성능 좋은 컴파일 방식의 언어이면서도, 런타임에 즉시 컴파일 하기에, 마치 인터프리터 방식의 언어처럼 꽤나 동적인 기능들이 막강합니다. 특히 REPL의 원조 LISP 가족인 만큼, 개발과정이 꽤나 다이내믹하고 상호대화적(interactive)합니다.

    (loop (print (eval (read))))

    REPL은 실제로 Lisp 함수들을 부르는 코드의 머릿글자로 만든 용어입니다.
    내가 REPL의 애비다.

언급할 만한 장점 중 첫째로, 클로저도 REPL 세션 하나 열어놓고 이거저거 입력하고 바로바로 확인해 가며 개발하는 흐름이 아주 매끄럽습니다. 단위 테스트 코드를 먼저 작성해가며 개발하는 TDD의 장점 중 하나가 빠른 피드백인데, 그보다도 훨씬 짧은 주기로 개발과 결과를 확인하면서 개발합니다. 코드를 작성하는 그 순간에 바로바로 결과를 봅니다.

둘째로, 클로저는 순수 함수형 언어는 아니지만, 꽤나 함수형에 치우친 접근을 취하고 있어서, 함수형 언어들이 자랑하는 우아한 면모도 꽤 뽐내고 있습니다. 다만, 제가 잘 설명할 자신은 없네요. 일단 요새 분위기는 "함수형 == 훌륭한 거" 아니겠습니까? 어렴풋한 지식으로 막연한 느낌이나마 요약하자면, 함수형 언어로 개발을 하다보면, 산만한 머리속 생각들이 자연이 깔끔하게 코드로 정리돼 발현되는 것 같습니다. 그렇지 않은 코드를 작성하기가 오히려 어렵습니다. 결과로 나온 코드는 간결하지만, 그런 코드를 작성하는 사고 과정은 간단치 않습니다. 그렇게 잘 정리된 코드만 작성하게 되기에 그걸 이해하는 측면에서는 쉽습니다. 적은 내용을 이해해도 그 내용이 함축적이고 명확합니다. 하도 장황해서 코드 몇페이지를 분석했는데도 결국 하는 일은 별개 없는 언어들과는 대조적입니다.

셋째로, 스칼라처럼 JVM 위에서 돈다는 점이 꽤나 매력적입니다. JVM처럼 성공적으로 널리 퍼지고 잘 쓰이는 플랫폼이 또 있을까 싶지요. 자바는 물론 JVM 환경의 다른 언어들이 생성해 내는 바이트코드들을 그대로, 그리고 아주 편리하게 가져다 쓸 수 있고, 또 인터페이스를 제공할 수 있다는 점도 큰 매력입니다. 내가 무언가 새로이 개발하는데, 관련한 라이브러리가 없다면, 다른 언어로도 없을 겁니다. 요새 세상에 자바로 라이브러리가 없는 분야가 있을까 싶네요. 그런 세상의 모든 라이브러리 코드들을 아주 쉽게 가져다 쓸 수 있으니, 새로운 언어에 있는 기본적 문제가 꽤 쉽게 해결되는 거죠. 그리고, 이미 운영중인 레거시 환경에서도 점진적으로, 또는 부분적으로 도입하기도 쉬울 겁니다. 이미 있는 자바코드들에 조금 덧붙이거나, 아니면 쓰고 있던 라이브러리 패키지들을 그냥 가져다 쓰는 거죠. 그리고, 개발과 함께 운영의 측면에서는 플랫폼의 모니터링을 비롯한 기술과 도구들이 함께 필요한데, 그런 것들은 그냥 JVM의 모든 것을 그대로 쓰면 되는 거지요.

마지막으로, 전에 클로저를 시작할 때 적었던 글에도 인용한 내용인데, 혹자는 리스프를 배우는 것 만으로도 훌륭한 프로그래머가 될 수 있다고 합니다. 실제로 리스프를 계속 쓰건 안쓰건, 그 사고 체계의 전환이 몇 단계 레벨 업된 프로그래머로 만들어 주는 거죠. 저는 렙업이 안되어 아직 모르겠습니다만, 언제가 되겠거니 믿어 보렵니다. 렙업 여부를 떠나, 분명 사고와 접근 방식이 많이 달라지는 것은 확실한 것 같습니다. 개인적으로도 자바 코드를 작성할 때조차도 그 전과는 다른 접근법을 쓰게 되는 것 같습니다. 과연 훌륭해지고 있는지는 몰라도요.

단점은, 너무도 생김새가 달라서 사람들이 어렵게 여긴다는 점입니다. 어렵게 보여서 에지간한 용기가 없이는 접근조차 하지 않으려 합니다. 저 또한 오래전 학창시절 수업 시간에 리스프를 처음 배웠을 때는,

    아 이건 나와 친해질 수 있는 언어가 아니구나

라고 생각했음을 고백합니다. 리스프 수업의 마지막 시험을 마치고, 바로 잊고 싶었던 그런 언어였습니다. 그런데 오랜 시간이 지난 이제서야, 이보다 간결할 수가 없다는 점을 깨닫게 되었습니다.

그리고, 애시당초 세상에 쉬운 프로그래밍 언어는 없습니다. 쉬워보여도 조금 하다보면 결국 어려운 게 개발이고, 처음엔 어려워 보여도 좀 하다보면 오히려 쉬울 수 있는 게 프로그래밍입니다. 쉽게 접근했다가 "내가 만만해 보였어?!"라며 뒷통수 겁나 후려치는 언어들도 있고, 리스프처럼 난공불락의 요새처럼 보였는데, 그 울타리 안으로 들어가면 유토피아가 펼쳐져 언어들이 있는 거죠.

## 그런 클로저를 업무로 쓰게 되다

클로저의 장점을 조금만 적으려 했는데, 어느새 제 손가락에 불이 나게 타이핑하고 있습니다. 폴 그레이엄 아재의 설파에 귀가 팔랑여 시작한 클로저 개발에 어느덧 빠져들고, 그래 이제 재밌게 개발할 수 있겠어. 개인적으로는 당분간 여기에 발을 담그겠다고 생각했으나, 그건 어디까지나 개인 프로젝트의 얘기일 뿐이었습니다.
