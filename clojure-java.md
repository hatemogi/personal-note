# 클로저와 자바, 다른 모습의 같은 플랫폼

> 특이한 프로그래밍 언어인 클로저(Clojure)는 혼자 개인적으로만 쓸 줄 알았습니다. 강력하고 매력 넘치는 프로그래밍 언어이긴 하지만, 다른 개발자들도 쉽게 좋아할 수 있는 언어는 아니라고 생각하거든요. 게다가 제가 속했던 조직에서 프로그래밍 언어의 사용 폭이 아주 제한적으로 수렴되는 경향을 보아왔고 그게 일반적이라고 여겼기 때문에, 앞으로도 클로저를 업무에 쓰리라는 기대는 별로 없었습니다. 그런데, 그런 일이 실제로 벌어졌습니다! 얼마전 서울에 위치한 스타트업 S사와 프로젝트 계약을 하게됐고, 뜻밖에도 클로저로 개발하게 된 거죠. 이런 배경에서, 언어의 선택에 대한 잡담을 털어 놓아 봅니다.

## 새로운 프로그래밍 언어를 배우기 어려운 이유

평소 업무로 쓰던 프로그래밍 언어가 아닌 다른 프로그래밍 언어를 재미로 배울 때 결정적인 문제는, 배우는 노력을 지속하기 어렵다는 점이 아닐까 합니다. 아무래도 반드시 매일 써야 하는 언어에 투자하는 노력과 재미삼아 배워보는 언어에 들이는 노력 사이에는 큰 차이가 나는 거지요. 간신히 새 언어에 관심이 생겨 큰 맘 먹고 책도 사고 문서도 읽어보며 공부하더라도, 결국 그걸 활용할 프로젝트나 함께 토론하며 개발할 동료가 없으니, 금새 시들해져 관심의 영역에서 떠나버리기 쉬운 것 같습니다. 프로그래밍 언어도 자주 써서 익숙해져야 진짜 내 것이 되는 것인데, 그때까지 노력을 지속하기 어려우니 말이죠.

저도 흥미롭게 공부하고 있는 쌈박한 프로그래밍 언어인 클로저(Clojure)도 마찬가지입니다. 참 매력적인 언어고 공부하면 할수록 프로그래밍 언어계의 끝판왕이라는 생각이 들지만, 평소 써먹을 일이 없으니, 괜한 입만만 다시다가 그만두게 되어 연습을 지속할 수 없는 거지요. 아무리 훌륭하면 뭐하나요? 써먹을 일이 없는데.

## 업무 환경에 새로운 언어를 도입하는 문제

그렇다고 나 혼자 욕심으로, 새로운 언어를 여럿이 함께 일하는 업무 환경에 끌어들이는 일은, 동료들의 성향은 물론, 소속한 조직의 정책을 포함한 다양한 저항이 크기에 현실적으로 어렵습니다. 아예 개발 판도 확 바뀌어 응당 "기본적으로" 해당 언어나 프레임워크를 새로 도입하는 상황이라면 모를까요. 이미 잘 쓰고 있는 언어 환경을 같은 목적의 다른 언어로 교체하는 것은 매우 어려운 일이고, 또 그래야 할 필요도 없습니다. 교체해서 얻는 잠재적 이득은 아직 불투명한데, 들여야 하는 뻔한 노력이 너무 크게 보여서, 현실적으로 옳은 선택이기 힘듭니다.  얻을 이득을 높게 평가하는 사람은 나 뿐이겠지만, 투자해야 하는 비용을 큰 손실로 여기는 반대편 사람이 대부분일 겁니다. 게다가 우리는 이득보다 손실을 더 크게 여기는 경향이 있습니다. 길을 걷다 1만원을  주운 즐거움의 크기보다 1만원을 잃었을 때의 아픔이 훨씬 큰 법입니다.

그렇기에, 예를 들어, 백엔드 개발에 이미 Java를 주로 쓰는 회사에서 갑자기 Ruby나 Python을 가져다 쓰겠다는 것은 괜한 마찰을 일으키고, 그걸 주장하는 개인도 아까운 에너지를 낭비하기 쉽습니다. 파이썬처럼 꽤 대중적인 언어를 도입하는 것도 힘든데, 하물며 해괴하게 생긴 클로저라구요? 에헤이, 그건 얼토당토 않은 바램인 거죠, 입도 뻥긋하지 마십시다요.

## 언어나 프레임워크 선택은 취향의 문제

프로그래밍 언어를 선택하는 것은 합리적인 판단의 영역으로 보이지만, 좀 따져보면 그 결정을 하는 사람들의 감성적 취향 문제가 아닌가 생각합니다. 감성적 취향이 먼저이고, 그 뒤에 나름의 합리화 과정이 따라오는 것으로 보입니다. 각자 주장하는 "어떤 언어가 이래서 좋다"는 여러 이성적 판단 기준이 있겠습니다만, 그렇다고 해서 다른 프로그래밍 언어로 그 일을 못하는 것도 아니고, 아주 뚜렷한 격차가 나는 것도 아닙니다. 한 언어가 뛰어난 점이 있으면 약점도 있고, 설령 약점이 더러 있더라도 그걸 이미 해당 언어 커뮤니티나 조직내 구성원들의 노력으로 보완해 놓은 경우가 많지요.

한편, 요새 세상에도 펄이나 코볼 같은 언어가 아직도 잘 쓰이고 있는 판에, 사실 언어의 기능적 제약 탓에 안 되는 일은 별로 없습니다. 어떻게든 실행 전에 기계어를 뽑아낼 수 있으면 되고, 아무리 무능한 언어라도 다른 호스트 시스템의 다른 언어 코드를 불러다 쓰는 길은 열려 있으니, 한 언어가 할 수 있는 일을 다른 언어라고 해서 못하는 일은 거의 없습니다. NASA에서 로켓을 쏘아 올리는데도 아직 코볼이나 포트란을 활발히 쓰고 있을 텐데, 구식의 언어라서 어떤 일을 못한다고 얘기할 수는 없잖아요. 우리가 개발 하는 일이 로켓을 쏴 올리는 일 만큼 최첨단(?)도 아닐 테고요.

어떤 팀의 구성원들이, 또는 개발자 혼자서 개인적으로 어떤 프로그래밍 언어를 택하는 문제에 있어서의 합리적 근거들을 곰곰히 따져보면, 전 그냥 취향의 문제로 보입니다. 호감이 가는 스타일이 있고, 그 스타일에 어울리는 언어는 좋은 언어이고, 그렇지 않은 언어는 나쁜 언어입니다. 언어가 갖고 있는 다양한 가치들을 각 개인이 얼마나 높은 가산점을 두고 판단 하느냐에 따라 총점이 달라지는 거라고 봅니다, 본인들은 아니라고 말 할지 모르겠지만요.

저도 제가 클로저를 좋아하는 이유는 매우 합리적이라고 여깁니다. 절대 감성적인 취향일리 없습니다, 분명히. ;-) 보시다시피 이렇게 합리적인 글을 쓰고 있지 않습니까? 유후후~ 씐난다!

## 프로그래밍 언어는 도구에 불과하다는 주장에 대해

이런 감성의 영역(?)이 커지다 보면 프로그래밍 언어가 마치 종교인 것처럼 깊게 빠져드는 사람들도 있고, 그 반대편에는 지나치게 합리적으로 프로그래밍 언어는 도구에 불과하다며 고상한척 거리감을 두고 바라보는 사람들도 있습니다. 어느 쪽 주장이 더 옳은 지는 모르겠지만, 진실은 그 중간 어디쯤에 있다고 말하면 틀림이 없을 것 같습니다. 프로그래밍 언어가 개발의 전부도 아니고, 그렇다고 도구에 불과한 것만은 아닌 그 중간 어디쯤인 거죠. 언어와 도구가 상호작용하는 것은 당연하고, 그 언어를 사용하는 커뮤니티의 성향과 문화에 따라서 어떤 일을 해내는 데 드는 노력과 우아함이 매우 다르기도 합니다. 그렇다고 해서 그게 전부라고 할 수도 없고요. 그 중간 어디쯤!

## Java의 장단점

자바는 제 직업 경력에서 가장 많이 활용한 언어이고, 지금도 제 생계소득을 받쳐주는 감사한 언어이지만, 개인적 취향에는 언어의 스타일이 너무 구체적이고 명시적이어서 좀 거북한 언어입니다. 사소하지만 간단한 예로, 요새 세상에 세미콜론이 필수인 언어가 웬 말인가요? 대체 세미콜론 따위가 왜 필수인 겁니까? 전반적으로 언어의 기본 스타일이 장황하다보니, 커뮤니티에서 태어나는 라이브러리나 프레임워크들도 그런 문화적 영향의 아래에 있는 것 같습니다. 뭐 하나 간단한 일을 하는 데도, 너무 거창하게 접근하는 게 아닌가 하는 생각이 종종 듭니다.

``` java
@CleverAnnotation(value="whatever", required=false)
public static final Optional<ResultWithNoSpecificFeatureOtherThanWrapping>  longMethodNameWithOverClarification(Stream<HeavyContainer<IFancyEntity>> inputStream) throws AnnoyingCheckedException {
   // Some tiny code shorter than method signature with no meaningful separation ...
}
```

위 코드는 웃자고 과장한 코드입니다만, 때로는 과도하게 명시적인 표현이 역으로 장점일 수도 있습니다. 여럿이서 팀으로 일할 때 표현이 구체적이어서 실수나 오해의 여지가 적다거나, 아니면 처음에 접근하기 쉬우니까 잠재적 추가 구성원을 구하기 쉽다거나 하는 다양한 장점들이 있지요. 제 개인 취향에 호감이 약할 뿐, 분명 현재 대중적으로는 압도적으로 많이 쓰이는 언어임에는 틀림 없습니다. 그리고, 언어 자체의 개인적 호감도를 떠나서 보면, 자바 생태계가 자랑하고 있는 각종 도구와 세상의 수많은 라이브러리들은 그 누구라도 높게 평가할 수 밖에 없는 매력 포인트일 겁니다.

## Clojure의 장단점

    (def 클로저 (+ JVM파워 LISP우아함 현대적-동시성-처리))

클로저는 LISP의 극도로 간단한 문법에, 동시성 처리를 위한 현대적 기능이 녹아들어 있는 JVM 기반의 프로그래밍 언어입니다. JVM용 바이트코드를 뽑아내는 성능 좋은 컴파일 방식의 언어이면서도, 런타임에 즉시 컴파일하기에, 마치 인터프리터 방식의 언어인 것처럼 동적으로 할 수 있는 일이 많습니다. 특히 REPL의 원조인, LISP 혈통인 만큼, 개발 과정이 꽤나 다이내믹하고 상호대화적(interactive)입니다.

    (loop (print (eval (read))))

    REPL은 실제로 Lisp 함수들을 부르는 코드의 머릿글자로 만든 용어입니다.
    내가 늬 REPL의 애비다.

언급할만한 장점 중 첫째, 클로저도 REPL 세션 하나 열어놓고 이거저거 입력하고 바로바로 확인해 가며 개발하는 흐름이 아주 매끄럽습니다. 단위 테스트 코드를 먼저 작성해가며 개발하는 TDD의 장점 중 하나가 빠른 피드백인데, 그보다도 더 짧은 주기로 결과를 바로바로 확인하면서 개발합니다. 단위 테스트를 자동이든 수동이든 돌리기도 전에, 코드를 타이핑하면서 그걸 그 자리에서 곧바로요. TDD가 개발 과정에서 선사하는 몰입(flow)의 즐거움을 느껴보신 분들이라면, RDD(REPL Driven Development)도 한 번 해보십시다. 그 몰입의 장벽이 더 낮아집니다. 더 빨리, 더 자주 몰입을 경험할 수 있습니다. 고도의 집중 상태에서 짧은 시간에 더 유용한 코드를 생산해 냅니다.

둘째, 클로저는 순수 함수형 언어는 아니지만, 꽤나 함수형에 치우친 언어여서, 함수형 언어들이 자랑하는 우아하고 적확한 면모도 꽤 드러나는 편입니다. 다만, 제가 잘 설명할 자신은 없네요. 일단 요새 분위기는 "함수형 == 훌륭한 거" 아니겠습니까? 어렴풋한 지식으로 막연한 느낌이나마 전달하자면, 함수형 언어로 개발하다보면, 산만한 머리 속 생각들이 강제로 깔끔하게 정리돼 표현되는 것 같습니다. 아니, 산만한 코드를 작성하기가 오히려 어렵습니다. 결과로 나온 코드는 간결하지만, 그렇다고 그런 코드를 작성하는 사고 과정까지 간단한 것은 아닙니다. 흔히 간단한 것을 쉬운 것과 상통한다고 여기기 쉬운데 그렇지 않습니다. 간결하게 하는 게 더 어려운 일이지요. 아무튼, 그렇게 논리정연하게 잘 정돈된 코드를 작성하게 되기에 그걸 이해하는 측면에서는 편합니다. 적은 내용을 이해해도 그 내용이 함축적이고 명확합니다. 하도 장황해서 코드 몇 페이지를 오랜 시간 분석했는데도 결국 하는 일은 별게 없는 일부 언어들과는 대조적입니다.

셋째, 스칼라처럼 JVM 위에서 돈다는 점이 꽤나 매력적입니다. JVM처럼 성공적으로 널리 퍼져 잘 쓰이는 플랫폼이 또 있을까 싶지요. 자바는 물론 JVM 환경의 다른 언어들이 생성해 내는 바이트 코드를 그대로 편리하게 가져다 쓸 수 있고, 또 클로저 코드를 JVM 환경의 다른 언어들이 쓸 수 있는 인터페이스를 제공할 수 있다는 점도 큰 매력입니다. 내가 무언가 새로이 개발하는데, 관련한 자바용 라이브러리가 없다면, 다른 언어로도 없을 겁니다. 사실상 세상의 모든 라이브러리 코드들을 아주 쉽게 가져다 쓸 수 있으니, 새로운 언어가 본질적으로 처하는 기본적 문제가 꽤 쉽게 해결되는 거죠. 또, 이미 운영중인 레거시 환경에서도 점진적으로, 또는 부분적으로 도입하기도 쉬울 겁니다. 이미 있는 자바 코드에 조금 덧붙이거나, 아니면 쓰고 있던 라이브러리 패키지를 그냥 가져다 쓰는 거죠. 그리고, 개발과 더불어 운영의 측면에서도 플랫폼 모니터링을 비롯한 기술, 도구, 그리고 경험적 인적 자산이 중요한데, 그런 것들은 그냥 기존의 JVM의 모든 것을 그대로 쓰면 되는 거지요.

마지막으로, 전에 클로저를 시작할 때 적었던 글에도 인용한 내용인데, 한 유명한 해커는 리스프를 배우는 것 만으로도 훌륭한 프로그래머가 될 수 있다고 말했습니다. 실제로 리스프 계통 언어를 계속 쓰건 안 쓰건, 그 과정에서 사고 방식의 전환으로만도 이미 몇 단계 레벨이 올라가는 거죠. 저는 아직 렙업이 안되어 잘 모르겠습니다만, 언젠가 되겠거니 하는 믿음은 생겼습니다. 렙업 여부를 떠나, 분명 사고와 접근 방식이 확연히 달라진 것 같습니다. 리스프를 경험하고 나니 자바 코드를 작성할 때조차도 그 전과는 다른 접근법을 쓰게 되는 것 같습니다. 과연 훌륭해지고 있는지는 몰라도요.

단점은, 너무도 생김새가 달라서 사람들이 어렵게 여긴다는 점입니다. 어렵게 보여서 에지간한 용기가 없이는 접근조차 하지 않으려 합니다. 저 또한 오래전 수업 시간에 리스프를 처음 배웠을 때는,

    아 이건 내가 함부로 친해질 수 있는 언어가 아니구나?!!

라고 생각했음을 고백합니다. 리스프로 배운 과목의 마지막 시험을 마치자 바로 잊고 싶었던 그런 언어였습니다. 그런데 이렇게 오랜 시간이 지난 이제서야, 이보다 간결할 수가 없다는 점을 깨닫게 된 거죠.

한 걸음 떨어져서 생각해 봅시다. 애시당초 세상에 쉬운 프로그래밍 언어는 어딨나요? 쉬워보여도 조금 하다보면 결국 어려운 게 개발이고, 처음엔 어려워 보여도 좀 하다보면 오히려 쉬울 수 있는 게 프로그래밍입니다. 쉽게 접근했다가 "내가 그렇게 만만해 보였니?!"라며 뒷통수 겁나 후려치는 언어들도 있고, 리스프처럼 난공불락의 요새처럼 보였는데, 막상 그 울타리 안으로 들어가면 유토피아가 펼쳐져 언어들이 있는 거죠. 심지어 그 울타리가 누구에게나 열려있을 줄이야.

장점은 애써 줄여 적었고, 단점은 간신히 하나 꼽았습니다, 믿거나 말거나.

## 클로저를 업무로 쓰게 되다

클로저의 장점을 조금만 적으려 했는데, 어느새 제 손가락에 불이 나게 타이핑하고 있습니다. 몇 년 전, 재밌는 책 "해커와 화가"를 읽으며 폴 그레이엄 아재의 설파에 제 귀가 팔랑여 시작한 클로저 개발에 어느덧 빠져들었고, 그래 이제 재밌게 개발할 수 있겠다 판단하고 당분간 여기에 발을 담그겠다고 생각했으나, 그건 어디까지나 개인적인 얘기일 뿐이죠.

그러다가 얼마전, 스타트업 S사와 개발 업무 계약을 맺었고, 원래는 Go 언어로 개발해 달라는 프로젝트를 수주했습니다만, 계약 후 Go 학습을 하던 과정에, 정말 특별한 상황의 반전이 일어나 클로저로 실제 업무를 진행하게 됐어요. 개인적으로는 좋기도 하고, 아쉽기도 합니다. 평소 즐겨 쓰는 클로저를 업무로도 쓸 수 있으니 좋고, 이 기회가 아니라면 Go를 따로 배울 일을 없을 텐데, 그 기회가 사라져 아쉽습니다.

또 한편, 전 결정 과정에서 꽤 소극적으로 대응하려 했습니다만, 그래도 클로저 유 경험자가 있다는 점이 적잖은 가산점을 받은 것 같습니다. [과거 D사 근무할 때 캘린더 서비스를 루비온레일스로 개발했던 후유증]을 오래 경험한 저로서는 어떤 환경에서 조금 생소한 언어나 프레임워크를 도입하는 것은 더 이상하고 싶지 않았습니다만, 어쩌다 보니 또 이렇게 됐습니다. 그냥 제 팔자인가 봅니다. 앞으로도 그렇게 살 것 같아요.

해당 개발팀의 멤버들이 약간의 호감만으로 클로저라는 새로운 언어를 받아들이고 시작하는 것에 적잖은 부담이 느껴집니다만, 한편으로는, 그 분들의 개발 인생에도 커다란 자산 하나를 선물해 드렸다고 생각합니다. 문제는 선물이라는 건 받는 사람이 선물이라 여겨야 선물인 점이죠. 부담이 이만 저만이 아닙니다. 그리고 전 일정기간 계약한  프리랜서인데, 혹시나 계약이 연장되지 않으면, 그 뒷감당을 곱게 받아줄 개발자가 나타나 주실지 미리 걱정이 앞섭니다. 혹시 이 글 읽고 계신가요? 마...ㅋ, 스카...ㅌ? 한편으로는 클로저 덕분에(?) 쉽게 계약이 종료될 것 같지는 않군요. 잇힝!

    의외의 소득인가?!

최근 몇 주 동안 업무로 클로저로 개발하고 있자니 매우 즐겁습니다. 클로저 프로그래밍은 다른 갖가지 요인 다 제외하고 보더라도, 일단 재밌습니다. 뭐니뭐니 해도 프로그래밍은 재미있어야 한다고 생각합니다. 더 이상 재미도 없고 배울 것도 없는 환경에서 적당한 월급만 챙기겠다고 만족하고 안도하며 과도히 오래 버티는 행위는 개발자 커리어에 있어 자살 행위라고 봅니다. 개발자 커리어 뿐인가요? 인생의 황금기에 있어 아까운 시간 낭비죠. 앗, 뜨끔!!!

뭐든 어떤 측면에서는 재미가 있어야, 더 열심히 배우며 적극적으로 일하고, 눈에 빛이 나고 생기가 돌지 않나요? 그렇다고 재미만 노리는 것은 어리석은 거고, 반대로 지나치게 차갑고 사무적으로만 대하는 것 역시 현명하진 않은 일 같아요. 이것도 그 중간 어딘가에 최적점이 있을 겁니다.

## 좋은 도구나 언어를 주변에 소개하는 옳바른 방법

좋은 것을 접하면, 주변 사람에게도 소개하고 싶은 마음이 드는 게 인지상정입니다만, 거기서 자칫 지나치기 쉽다는 함정이 있습니다. 백 번 양보해서 기존 언어 대비 훌륭한 언어라고 인정한다 치더라도, 그런 훌륭한 언어를 쓴다는, 아니 그런 언어를 선택했다는, 배경만으로 내가 훌륭한 것은 아닙니다. 하지만 그 과정에서 우리의 에고가 끼어들어, "난 이런 훌륭한 언어를 알고 있고, 다른 사람들은 아직 모르니까 미개해. 미개한 종족들을 내가 깨우쳐 줘야겠어" 하는 마음이 들거나, 아니면 본인은 진정 그런 마음이 없더라도, 다른 사람들은 그렇게 오해하기 쉽습니다. 도로에서 좋은 차를 탄다고 해서 그 운전자가 좋은 사람은 아니고, 큰 차를 탄다고 해서 운전자 덩치가 큰 것도 아닙니다. 그리고, 뭐 고작 훌륭한 언어를 쓴다는 사실로 스스로를 훌륭하다고 여긴다면, 그런 언어를 만든 인간은 대체 뭡니까? 신입니까?!

    오, Rich Hickey 신이시여!

게다가 일반적으로, 다른 사람들이 원치 않는 도움을 주려는 것은 본인 생각에는 뜻깊은 배려일지 몰라도, 상대의 입장에서는 실례가 되기도 하지요. 생판 낯선 언어를 힘들여 배울 생각은 손톱 만큼도 없는데, 곁에서 자꾸 뜬금포 쏴대면 귀찮은 스패머와 다를 바 없습니다.

그래서 정신 차리고 그저 묵묵히 혼자만 좋은 걸 누리면서 지내는 게 현명한 처사로 보이기도 합니다. 현명하지만 고독한 처사이지요. 어떤 이유로 시작했든, 해보니 정말 좋은 잇점이 나름 검증됐다면 주변 사람들에게도 잘 알려줄 의무감이 생기는 것 같습니다. 그런 의무감을 외면하고 지내면 점점 더 스스로 고독해지는 것이 아닐까요? 사회적 인간으로서의 자연스러운 공유 욕구를 충족하면서도, 주변에 실질적이 도움이 되는 효과적인 방법은 무엇일까요?

우선 감성이나 흥분은 좀 가라앉히고, 현실적으로 납득할만한 사실만을 건조하게 소개하는 것이 중요하겠습니다. 그리고, 생소한 언어를 새로 배우는 일은 누구라도 힘든 일이기에, 아무리 좋은 언어라 할지라도 쉽게 마음이 동하는 사람은 많지 않다는 점을 충분히 인식하고, 거절의 가능성이 훨씬 높다는 점을 인지해야 하겠습니다. 새로운 언어의 제안은 거절이 기본이니, 그 거절로 인해 상처를 받는다거나 해서는 안되겠죠.

소개하는 언어의 장점은 강조하되, 그렇다고 기존 언어의 단점을 지적하는 것은 자제하는 편이 좋은 것 같습니다. 아무래도 상대적 비교로 장점을 홍보하는 것이 효과적이겠거니 생각하기 쉬운데, 심리적으로는 역효과가 나는 것 같습니다. 상대가 뭔가 공격 받는 기분이 들면, 그에 따르는 당연한 반응은 방어 또는 역공인데 둘 다 새 언어를 소개하고자 했던 목표와는 멀어지게 됩니다.

## 차라리 대상의 범위를 넓히자

## 소극적으로 도입하는 방법의 하나
