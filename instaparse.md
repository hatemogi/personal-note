# 마크다운 파서 만들기 - 합리화와 사전조사편

[마크다운 문서로부터 Tufte CSS를 적용한 HTML 문서를 만들어내면 좋겠다]()고 생각했다. 일일이 HTML 마크업을 꾸며 웹문서를 만드는 일은, 아무리 훌륭한 에디터가 있다 해도 번거로운 일이기 때문이다.

그런데, 마크다운 표준 문법에는 [Tufte CSS][]에서 쓰는 각주 표현이 없어서, 해당 기능을 덧붙여야 할 것 같다. 이미 세상에 좋은 마크다운 파서는 널려 있으므로, 그중 기능을 덧붙이기 쉬운 파서를 찾아서 손을 보면 간단하게 만들 수 있겠다. 아니면, 애써 파서까지 건드리지 말고, [Pandoc][]같은 도구를 잘 써서 원하는 결과를 뽑을 수도 있을 것 같다.

한편, 어떤 일을 할 때, 아래쪽 바닥부터 시작하는 방법도 재미있거나 유익한 때도 있다. 물론 이미 있는 바퀴를 재개발한다고 지적을 받기도 하고, 새로 만들어 봤자 이미 공개된 훌륭한 제품의 품질을 따라가기 어렵다는 면에서 삽질로 치부되기 쉽다. 그러나, 배우는 사람 입장에서는 가끔 흥미가 있는 주제를 잡아 직접 만들어 보는 것도 좋은 경험이 될 수 있다. 드는 시간과 노력의 관점에서 보면 비효율적이고, 결국 삽질 끝에 쓸모 없는 걸 만들게 되기도 하지만 배우는 게 원래 그런 거지 뭐.

그리고 사실 회사 다닐 때와 가장 큰 차이점 중 하나는, 이제 더 이상 무언가를 할 때 나 자신을 포함한 누군가를 설득할 필요가 없다는 점이다. 원래 사람 심리가 그런 것인지, 아니면 오랜 사회 생활로 물든 건지 모르겠지만, 반드시 무언가 합리적인 이유를 근거 삼아 일을 시작해야 한다는 강박이 있는 것 같은데, 개인 프로젝트에는 그럴 필요가 없다. 그저 재밌을 것 같으면 하면 된다. 흥미가 가면 행동도 간다. 그렇다고 너무 다 바닥부터 만들려고 해도 문제이고, 너무 가져다가 쓰려고만 하는 접근도 옳지 않을 터. 각자 때때로 원하는 비율로 조절해서 작업하면 된다. 그러다 보면 뭐라도 배우는 거고.

암튼, 아직 그 강박을 벗어나지 못한채 이런 장황한 합리화를 거쳐, 손수 마크다운 파서를 만들어 보겠다는 마음먹었다. 고고씽.

> 마크다운 파서를 직접 만들어서 [Tufte CSS]를 적용한 HTML 문서를 마구 찍어내 보자.

## 파서 생성기를 배운 시절

파서 생성기(parser generator), 참 오랜만에 듣는 용어다. 학교 다닐 때, lex나 yacc같은 스캐너(scanner) 생성기와 파서(parser) 생성기를 어쩔 수 없이 썼지만, 잘 알고 쓰는 건 아니고, 과제하느라 아주 기본적인 사용법을 간신히 익히는 수준이었다.

컴퓨터 공학을 전공하지 않은 동료 개발자 중에 비전공자임에 열등감을 토로하는 분들이 가끔 있었는데, 사실 그런 열등감은 누구에게나 이따금씩 드러나는 수준이 아닌가 생각한다. 오히려 나같은 전공자는, 본인이 비싼 등록금 내며 무려 4년을 배웠고 분명 그 내용을 배우며 과제를 하고 시험을 치렀다는 사실을 기억하고 있지만, 정작 그 내용 자체는 이제 잘 모른다는 점에 컴플렉스가 있다. 어차피 지금 모르는데, 전공한 것과 아닌 것의 차이는 무엇인가?

어느 쪽이 더 열등한 건지는 모르겠지만, 암튼 열등감을 느끼는 사람이 열등한 거지, 전공을 했고 안 했고는 크게 중요한 기준점이 아닌 것 같다. 그냥 그럴 시간에 모르는 거 더 공부하면 되는 거다. 비전공자라고 주눅들지 말자. 뭐 석박사도 아니고 고작 학사 전공한 것 가지고 으스대는 사람도 없을 텐데 왜 스스로 그러는지 모르겠다. 뭐, 이렇게 얘기하는 나도 전공 석박사 타이틀 있는 사람들에게 괜한 열등감이 스멀스멀 올라올 때도 있음을 고백한다. 그러니 이건 '있는 자의 어설픈 조언'이 아니라 '동병상련을 바탕으로 한 제안'이다, 우리 그러지 말자. 석박사는 석박사 나름 대로, 연구실에서 교수님 수발드는 동안 남들은 사회생활하면서 조금씩이나마 돈을 벌어 놓았다는 점을 부러워할지도 모른다.

## Instaparser: 클로저용 파서 생성기

이 글의 출발점인 [Instaparser]는 클로저용 CFG(Context-Free Grammar) 파서 생성기이다. 현재기준 깃헙 스타 수가 1,500에 육박한다. 모수가 많지 않은 클로저 바닥을 고려할 때 꽤 높은 수치다. 게다가 파서 생성기라는 주제는 대상이 한정적이라는 점까지 생각해보면 정말 상당한 수다. 관심 있는 사람이 많다는 것은, 쓰는 사람이 많다는 얘기와 이어지고, 그러면 나름 탄탄하게 믿고 쓸만할 가능성이 크다. 그래 믿고 시간을 투자해보자.

그리고, 이건 클로저용 파서 생성기 이야기지만, 사실 파서 생성기 없는 프로그래밍 언어는 없을테니, 어떤 프로그래밍 언어를 쓰더라도, 전체 맥락을 함께 이해하는데는 큰 문제가 없을 것이다, 아마도.

아래는, 인스타파서의 소개문(?)이다.

> What if context-free grammars were as easy to use as regular expressions?

만약 CFG를 쓰는 것이 정규표현식(regular expression)을 쓰는 것처럼 쉽다면? 정규표현식이야 워낙 자주 편리하게 쓰니 익숙한데, CFG를 그렇게 쉽게 쓸 수 있다고? 그게 말이 되나? 이런 의심이 들면서도 혹해서, 이미 난 나머지 긴 설명을 읽고 있었다.

## 자유 문맥 문법 (CFG, Context-free Grammar)

여기서 잠깐, CFG가 대체 뭔가? 파서를 만들 때 EBNF와 함께 들어 본 용어같긴 한데, 뭔지 모르겠다, 찾아보자.

[Tufte CSS]: http://edwardtufte.github.io/tufte-css/
[Pandoc]: http://pandoc.org
[Instaparser]: https://github.com/Engelberg/instaparse
